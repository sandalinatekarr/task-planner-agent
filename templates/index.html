<!doctype html>
<html>
<head>
  <title>Task Planner Agent</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">
  <h1>Task Planner Agent</h1>
  <form id="goalForm">
    <input id="goalInput" class="form-control" placeholder="Enter your goal, e.g., Plan a 5-day trip to Goa with beaches, sightseeing, and food">
    <button class="btn btn-primary mt-2" type="submit">Generate Plan</button>
    <a href="/history" class="btn btn-outline-secondary mt-2">View History</a>
  </form>
  <hr>
  <div id="result"></div>
</div>
<script>
document.getElementById("goalForm").onsubmit = async e => {
  e.preventDefault();
  const goal = document.getElementById("goalInput").value;
  const resp = await fetch("/api/plan", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({goal})
  });
  const data = await resp.json();
  if(data.plan){
    let html = `<h3>${data.plan.summary}</h3>`;
    html += `<h5>Steps:</h5><ul>${data.plan.steps.map(s => `<li>${s}</li>`).join('')}</ul>`;
    html += `<h5>Day by Day:</h5>`;
    data.plan.day_by_day.forEach(d=>{
      html += `<strong>Day ${d.day}:</strong><ul>${d.activities.map(a=>`<li>${a}</li>`).join('')}</ul>`;
    });
    document.getElementById("result").innerHTML = html;
  } else {
    document.getElementById("result").innerText = JSON.stringify(data, null, 2);
  }
};
</script>
</body>
</html>
